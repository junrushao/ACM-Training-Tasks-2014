<html xmlns="http://www.w3.org/TR/REC-html40" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word"><head><style>   body { font-family: 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif; }</style>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="Word.Document" name="ProgId">
<meta content="Microsoft Word 11" name="Generator">
<meta content="Microsoft Word 11" name="Originator">
</head>
<body style="tab-interval:35.45pt;line-break:strict" bgcolor="white" lang="EN-US">
<div class="Section1">
<p class="MsoBodyText"><o:p>&nbsp;</o:p></p>
<table class="MsoNormalTable" style="margin-left:2.1pt;border-collapse:collapse;mso-padding-alt:2.75pt 2.75pt 2.75pt 2.75pt" border="0" cellpadding="0" cellspacing="0">
<tbody><tr style="mso-yfti-irow:0;mso-yfti-firstrow:yes;height:59.05pt">
<td rowspan="3" style="width:67.6pt;border:solid black 1.0pt;
  border-right:none;mso-border-top-alt:solid black .25pt;mso-border-left-alt:
  solid black .25pt;mso-border-bottom-alt:solid black .25pt;background:#B3B3B3;
  padding:2.75pt 2.75pt 2.75pt 2.75pt;height:59.05pt" width="90">
<p class="TableContents" style="text-align:center;layout-grid-mode:
  char" align="center"><b><span style="font-size:72.0pt">A<o:p></o:p></span></b></p>
</td>
<td colspan="2" style="width:414.75pt;border:solid black 1.0pt;
  mso-border-alt:solid black .25pt;padding:2.75pt 2.75pt 2.75pt 2.75pt;
  height:59.05pt" width="553">
<p class="TableContents" style="text-align:center;layout-grid-mode:
  char" align="center"><span style="font-size:36.0pt">Dazzling Puzzle<o:p></o:p></span></p>
</td>
</tr>
<tr style="mso-yfti-irow:1;height:18.55pt">
<td style="width:209.1pt;border-top:none;border-left:
  solid black 1.0pt;border-bottom:solid black 1.0pt;border-right:none;
  mso-border-left-alt:solid black .25pt;mso-border-bottom-alt:solid black .25pt;
  padding:2.75pt 2.75pt 2.75pt 2.75pt;height:18.55pt" valign="top" width="279">
<p class="TableContents" style="text-align:right;layout-grid-mode:
  char" align="right"><span style="font-size:10.0pt">Input<o:p></o:p></span></p>
</td>
<td style="width:205.65pt;border:solid black 1.0pt;
  border-top:none;mso-border-left-alt:solid black .25pt;mso-border-bottom-alt:
  solid black .25pt;mso-border-right-alt:solid black .25pt;padding:2.75pt 2.75pt 2.75pt 2.75pt;
  height:18.55pt" valign="top" width="274">
<p class="TableContents" style="layout-grid-mode:char"><span style="font-size:
  10.0pt">Standard Input<o:p></o:p></span></p>
</td>
</tr>
<tr style="mso-yfti-irow:2;mso-yfti-lastrow:yes;height:1.15pt">
<td style="width:209.1pt;border-top:none;border-left:
  solid black 1.0pt;border-bottom:solid black 1.0pt;border-right:none;
  mso-border-left-alt:solid black .25pt;mso-border-bottom-alt:solid black .25pt;
  padding:2.75pt 2.75pt 2.75pt 2.75pt;height:1.15pt" valign="top" width="279">
<p class="TableContents" style="text-align:right;layout-grid-mode:
  char" align="right"><span style="font-size:10.0pt">Output<o:p></o:p></span></p>
</td>
<td style="width:205.65pt;border:solid black 1.0pt;
  border-top:none;mso-border-left-alt:solid black .25pt;mso-border-bottom-alt:
  solid black .25pt;mso-border-right-alt:solid black .25pt;padding:2.75pt 2.75pt 2.75pt 2.75pt;
  height:1.15pt" valign="top" width="274">
<p class="TableContents" style="layout-grid-mode:char"><span style="font-size:
  10.0pt">Standard Output<o:p></o:p></span></p>
</td>
</tr>
</tbody></table>
<p class="MsoNormal" style="margin-left:16.55pt"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal" style="margin-left:16.55pt;text-align:justify">All of you know
the famous 15 puzzle problem. For those, who are not familiar with 15-puzzle,
don<span style="font-family:&quot;DejaVu Sans&quot;;mso-ascii-font-family:
&quot;Liberation Serif&quot;" lang="AR-SA">’</span>t worry, I am adding some description here.</p>
<p class="MsoNormal" style="margin-left:16.55pt;text-align:justify"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal" style="margin-left:16.55pt;text-align:justify"><!--[if gte vml 1]><v:shapetype
 id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t"
 path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_s1026" type="#_x0000_t75" style='position:absolute;
 left:0;text-align:left;margin-left:0;margin-top:4.85pt;width:131pt;height:146.1pt;
 z-index:1;mso-wrap-distance-left:9.05pt;mso-wrap-distance-right:9.05pt;
 mso-position-horizontal:left' filled="t">
 <v:fill opacity="0" color2="black"/>
 <v:imagedata src="a_files/image001.jpg" o:title=""/>
 <w:wrap type="square"/>
</v:shape><![endif]--><!--if !vml!--><img src="a_data/p11794a.gif" v:shapes="_x0000_s1026" align="left" height="195" hspace="12" width="175"><!--endif!-->In
a 15-puzzle, a <b style="mso-bidi-font-weight:normal">4 x 4</b> grid is given,
where we have 15 cells numbered from 1 to 15 and the remaining cell is empty.
Initially the board is scattered. Each time you can move one cell to the empty
cell if the cell is vertically or horizontally adjacent to the empty cell. For
example, see the board at the left. So, we can bring 6, 5, 7 or 12 in the empty
cell in the first move. For this problem, we will consider the moves based on
the empty cell, and the moves are <span style="font-family:&quot;DejaVu Sans&quot;;
mso-ascii-font-family:&quot;Liberation Serif&quot;" lang="AR-SA">‘</span>l<span style="font-family:&quot;DejaVu Sans&quot;;mso-ascii-font-family:&quot;Liberation Serif&quot;" lang="AR-SA">’</span>,
<span style="font-family:&quot;DejaVu Sans&quot;;mso-ascii-font-family:&quot;Liberation Serif&quot;" lang="AR-SA">‘</span>r<span style="font-family:&quot;DejaVu Sans&quot;;mso-ascii-font-family:&quot;Liberation Serif&quot;" lang="AR-SA">’</span>,
<span style="font-family:&quot;DejaVu Sans&quot;;mso-ascii-font-family:&quot;Liberation Serif&quot;" lang="AR-SA">‘</span>u<span style="font-family:&quot;DejaVu Sans&quot;;mso-ascii-font-family:&quot;Liberation Serif&quot;" lang="AR-SA">’</span>
or <span style="font-family:&quot;DejaVu Sans&quot;;mso-ascii-font-family:
&quot;Liberation Serif&quot;" lang="AR-SA">‘</span>d<span style="font-family:&quot;DejaVu Sans&quot;;
mso-ascii-font-family:&quot;Liberation Serif&quot;" lang="AR-SA">’</span>, which mean the empty cell
is taken to left, right, up or down respectively. So, for the board shown here,
we have 4 possible moves. They are given below.</p>
<p class="MsoNormal" style="margin-left:16.55pt;text-align:justify"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal" style="margin-left:16.55pt;text-align:center" align="center"><!--[if gte vml 1]><v:shape
 id="_x0000_i1025" type="#_x0000_t75" style='width:419.25pt;height:118.5pt'
 filled="t">
 <v:fill opacity="0" color2="black"/>
 <v:imagedata src="a_files/image003.jpg" o:title=""/>
</v:shape><![endif]--><!--if !vml!--><img src="a_data/p11794b.gif" v:shapes="_x0000_i1025" height="158" width="559"><!--endif!--></p>
<p class="MsoNormal" style="margin-left:16.55pt;text-align:justify"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal" style="margin-left:16.55pt;text-align:justify">In a
15-puzzle game, you are given a board configuration. You have to use these
moves to make the following board configuration.</p>
<p class="MsoNormal" style="margin-left:16.55pt;text-align:center" align="center"><!--[if gte vml 1]><v:shape
 id="_x0000_i1026" type="#_x0000_t75" style='width:99pt;height:108.75pt'
 filled="t">
 <v:fill opacity="0" color2="black"/>
 <v:imagedata src="a_files/image005.jpg" o:title=""/>
</v:shape><![endif]--><!--if !vml!--><img src="a_data/p11794c.gif" v:shapes="_x0000_i1026" height="145" width="132"><!--endif!--></p>
<p class="MsoNormal" style="margin-left:16.55pt;text-align:justify">But for this
problem, the board you are dealing with is not necessarily <b style="mso-bidi-font-weight:
normal">4 x 4</b>. You will be given an <b><i>N</i></b><b style="mso-bidi-font-weight:
normal"> x <i>N</i></b> board. In the board, there will be integers from <b style="mso-bidi-font-weight:normal">0</b> to <b style="mso-bidi-font-weight:
normal">(<i>N</i> * <i>N</i> </b><b style="mso-bidi-font-weight:normal"><span style="font-family:&quot;DejaVu Sans&quot;;mso-ascii-font-family:&quot;Liberation Serif&quot;" lang="AR-SA">–</span>
1), </b>each exactly once. Here <b style="mso-bidi-font-weight:normal">0</b>
denotes the empty cell. You have to use the moves like the 15-puzzle to make
the board such that if you traverse the board in row major order, then you will
find the positive integers in increasing order and the last cell, which means
the cell in last row and last column, is the empty cell. Remember that there
can be multiple solutions; you can output any one of them.</p>
<h2 style="margin-left:16.55pt;text-indent:0in">Input</h2>
<p class="Constraints" style="text-align:justify">Input starts with an integer <b><i>T
</i><span style="mso-bidi-font-style:italic">(</span></b><b><i><span style="mso-fareast-font-family:&quot;Liberation Serif&quot;;mso-bidi-font-family:
&quot;Liberation Serif&quot;" lang="AR-SA">≤</span></i><span style="mso-bidi-font-style:italic">100)</span></b>,
denoting the number of test cases.</p>
<p class="MsoBodyText" style="margin-left:16.55pt;text-align:justify">Each test
case starts with an integer <b style="mso-bidi-font-weight:normal"><i>N</i></b>
<b style="mso-bidi-font-weight:normal">(3 </b><b><i><span style="mso-fareast-font-family:&quot;Liberation Serif&quot;;mso-bidi-font-family:&quot;Liberation Serif&quot;" lang="AR-SA">≤</span></i></b><b style="mso-bidi-font-weight:normal"><span lang="AR-SA"> </span><i>N</i> </b><b><i><span style="mso-fareast-font-family:&quot;Liberation Serif&quot;;mso-bidi-font-family:
&quot;Liberation Serif&quot;" lang="AR-SA">≤</span></i></b><b style="mso-bidi-font-weight:normal">
50)</b> denoting the dimension of the board. The next <b style="mso-bidi-font-weight:
normal"><i>N</i></b> lines will contain <b style="mso-bidi-font-weight:normal"><i>N</i></b>
integers each, which will be separated by one or more spaces. You can assume
that the board configuration is correct. That means that the board will contain
all the integers from <b style="mso-bidi-font-weight:normal">0</b> to <b style="mso-bidi-font-weight:normal">(<i>N</i> * <i>N</i> - 1)</b>.</p>
<h2 style="margin-left:16.55pt;text-indent:0in">Output</h2>
<p class="MsoBodyText" style="margin-left:16.55pt;text-align:justify">For each
case print the case number first. If the board is already solved then print <b style="mso-bidi-font-weight:normal"><span style="font-family:&quot;DejaVu Sans&quot;;
mso-ascii-font-family:&quot;Liberation Serif&quot;" lang="AR-SA">‘</span></b><b style="mso-bidi-font-weight:
normal"><span style="font-family:&quot;Courier New&quot;">solved</span></b><b style="mso-bidi-font-weight:normal"><span style="font-family:&quot;DejaVu Sans&quot;;
mso-ascii-font-family:&quot;Liberation Serif&quot;" lang="AR-SA">’</span></b>. If the given board is
not solvable then pri<span style="mso-fareast-font-family:&quot;Liberation Serif&quot;">nt
<span lang="AR-SA">‘</span></span><b style="mso-bidi-font-weight:normal"><span style="font-family:&quot;Courier New&quot;;mso-fareast-font-family:&quot;Liberation Serif&quot;;
mso-bidi-font-family:&quot;Courier New&quot;">impossible</span></b><b style="mso-bidi-font-weight:
normal"><span style="mso-fareast-font-family:&quot;Liberation Serif&quot;;
mso-bidi-font-family:&quot;Courier New&quot;" lang="AR-SA">’</span></b>. Otherwise print the moves.
See the samples for more details. You are not allowed to use more than <b style="mso-bidi-font-weight:normal">8 * <i>N</i><sup>3</sup></b> moves.</p>
<table class="MsoNormalTable" style="margin-left:2.75pt;border-collapse:collapse;mso-padding-alt:2.75pt 2.75pt 2.75pt 2.75pt" border="0" cellpadding="0" cellspacing="0">
<tbody><tr style="mso-yfti-irow:0;mso-yfti-firstrow:yes">
<td style="width:249.25pt;border:solid black 1.0pt;
  border-right:none;mso-border-top-alt:solid black .25pt;mso-border-left-alt:
  solid black .25pt;mso-border-bottom-alt:solid black .25pt;padding:2.75pt 2.75pt 2.75pt 2.75pt" valign="top" width="332">
<p class="TableContents" style="margin-left:16.4pt;layout-grid-mode:char"><b>Sample
  Input<o:p></o:p></b></p>
</td>
<td style="width:232.2pt;border:solid black 1.0pt;
  mso-border-alt:solid black .25pt;padding:2.75pt 2.75pt 2.75pt 2.75pt" valign="top" width="310">
<p class="TableContents" style="margin-left:16.4pt;layout-grid-mode:char"><b>Sample
  Output<o:p></o:p></b></p>
</td>
</tr>
<tr style="mso-yfti-irow:1;mso-yfti-lastrow:yes">
<td style="width:249.25pt;border-top:none;border-left:
  solid black 1.0pt;border-bottom:solid black 1.0pt;border-right:none;
  mso-border-left-alt:solid black .25pt;mso-border-bottom-alt:solid black .25pt;
  padding:2.75pt 2.75pt 2.75pt 2.75pt" valign="top" width="332">
<p class="SampleIO" style="layout-grid-mode:char">3</p>
<p class="SampleIO" style="layout-grid-mode:char">4</p>
<p class="SampleIO" style="layout-grid-mode:char"><span style="mso-spacerun:yes">&nbsp;</span>2<span style="mso-spacerun:yes">&nbsp;
  </span>3<span style="mso-spacerun:yes">&nbsp; </span>6<span style="mso-spacerun:yes">&nbsp; </span>4</p>
<p class="SampleIO" style="layout-grid-mode:char"><span style="mso-spacerun:yes">&nbsp;</span>1<span style="mso-spacerun:yes">&nbsp;
  </span>5<span style="mso-spacerun:yes">&nbsp; </span>0<span style="mso-spacerun:yes">&nbsp; </span>7</p>
<p class="SampleIO" style="layout-grid-mode:char">10 11 12<span style="mso-spacerun:yes">&nbsp; </span>8</p>
<p class="SampleIO" style="layout-grid-mode:char"><span style="mso-spacerun:yes">&nbsp;</span>9 13 14 15</p>
<p class="SampleIO" style="layout-grid-mode:char">3</p>
<p class="SampleIO" style="layout-grid-mode:char">1 2 3</p>
<p class="SampleIO" style="layout-grid-mode:char">4 5 6</p>
<p class="SampleIO" style="layout-grid-mode:char">8 7 0</p>
<p class="SampleIO" style="layout-grid-mode:char">3</p>
<p class="SampleIO" style="layout-grid-mode:char">1 2 3</p>
<p class="SampleIO" style="layout-grid-mode:char">4 5 6</p>
<p class="SampleIO" style="layout-grid-mode:char">7 8 0</p>
<p class="SampleIO"><o:p>&nbsp;</o:p></p>
</td>
<td style="width:232.2pt;border:solid black 1.0pt;
  border-top:none;mso-border-left-alt:solid black .25pt;mso-border-bottom-alt:
  solid black .25pt;mso-border-right-alt:solid black .25pt;padding:2.75pt 2.75pt 2.75pt 2.75pt" valign="top" width="310">
<p class="SampleIO" style="layout-grid-mode:char">Case 1: ulldrrrdllldrrr</p>
<p class="SampleIO" style="layout-grid-mode:char">Case 2: impossible</p>
<p class="SampleIO" style="layout-grid-mode:char">Case 3: solved</p>
<p class="SampleIO"><o:p>&nbsp;</o:p></p>
</td>
</tr>
</tbody></table>
<p class="MsoBodyText" style="margin-left:16.4pt;tab-stops:73.5pt"><o:p>&nbsp;</o:p></p>
<p class="MsoBodyText" style="tab-stops:73.5pt"><i>This is a special judge
problem, so, wrong output format may also cause wrong answer.</i></p>
</div>


</body></html>