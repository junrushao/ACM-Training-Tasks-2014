<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- saved from url=(0038)http://172.16.45.6/problems/4704/html/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style>   body { font-family: 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif; }</style><meta content="width=768" name="viewport"><meta content="IE=edge" http-equiv="X-UA-Compatible"><title>1912. Titan Ruins: Passing through Walls @ Timus Online Judge</title><style type="text/css"></style></head><body alink="#1A5CC8" link="#1A5CC8" vlink="#1A5CC8"><div class="prnver"><h2 class="problem_title">1912. Titan Ruins: Passing through Walls</h2><div class="problem_limits">Time limit: 1.0 second<br>Memory limit: 64 MB<br><br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">Soren opened his eyes with an effort but this didn't help much—there was a deaf darkness around.
An unbearable pain in the back of his head prompted that he had hit his head in the fall.
Spreading his arms he realized that he was in a very small room without any openings.
Luckily, the wand was intact, which meant that Soren could still use magic.</div></div><div class="problem_par"><div class="problem_par_normal">Casting the Scanning Spell, he discovered disappointingly that identical small square rooms with solid walls were spreading evenly in all directions.
There was only one thing to be glad about—Alba, still alive, was in the adjoining room. Soren contacted him telepathically.<br>
`Are you alright?'<br>
`Almost.'<br>
`Have you got any ideas on how to get out of here?'<br>
`There's no way out through the top, but we can try passing through the walls. Some of them are thinner than others.
If we combine our powers, we can take one of us through a thin wall. It's a pity the rooms are so small—we can't get into the same room together.
And we always have to stay in rooms that have at least one common corner so that we can keep contact. It'll be hard, but let's try.'<br><br><br><br></div></div><div class="problem_par"><div class="problem_par_normal">Soren draw a scheme of all the rooms and marked thin and thick walls. It turned out that all the rooms together formed a large rectangle,
around which there were no walls, so that it was possible to move freely anywhere outside the rectangle.
Now Alba and Soren had to understand how they should move between the rooms to get both of them out of the trap.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains the dimensions of the rectangle <i>n</i> and <i>m</i> (2 ≤ <i>n</i>, <i>m</i> ≤ 250).
In the following 2<i>n</i> + 1 lines you are given a scheme of the trap. There are 2<i>m</i> + 1 symbols in each line.
Soren and Alba are denoted by the symbols “1” and “2”; their rooms have at least one common corner.
The symbols “|” and “-” denote thick walls. The symbols “.”, “+”, and “ ” denote thin walls, corners, and empty rooms, respectively.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">If Soren and Alba can't get out of the trap, output the line “Death”. Otherwise, output the minimum number of passages through thin walls that Soren and Alba must make to free themselves.</div></div><h3 class="problem_subtitle">Samples</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre class="intable">3 4
+.+-+-+-+
| . .1. |
+-+-+-+.+
| .2. . |
+.+.+.+-+
| . | | |
+.+.+-+-+
</pre></td><td><pre class="intable">13
</pre></td></tr><tr><td><pre class="intable">2 2
+-+-+
.1|2.
+-+-+
| | |
+-+-+
</pre></td><td><pre class="intable">Death
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Stanislav Vasilyev (prepared by Denis Mukhametianov)<br><b>Problem Source: </b>NEERC 2012, Eastern subregional contest<br><br></div></div></div><script type="text/javascript" async="" src="watch.js"></script><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({id:20918869, webvisor:true, clickmap:true, trackLinks:true, accurateTrackBounce:true}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img alt="" src="http://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;"/&gt;&lt;/div&gt;</noscript><iframe name="RemoteIframe" allowtransparency="true" style="position: absolute; left: -999px; top: -999px; width: 1px; height: 1px;"></iframe></body></html>