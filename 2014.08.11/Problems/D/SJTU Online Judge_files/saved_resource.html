
<!-- saved from url=(0038)http://172.16.45.6/problems/8350/html/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style>   body { font-family: 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif; }</style><meta content="HDOJ ACM ICPC OJ C C++ Pascal Java" name="keywords"><style type="text/css">body
{
	font-size:14px;
	font-family:Times New Roman;
	background: url(background.jpg);
}

a{ color:#1a5cc8; text-decoration:none }
a:hover { color:orange; text-decoration:underline }
textarea { border:#879BFF 1px dashed; background-color: F4FBFF }
input { border:#879BFF 1px dashed; font-size:14px; background-color:transparent; vertical-align: middle }
select { margin: -2px; background-color:F4FBFF }
img { border: none}
hr { height: 1px; border: 0; border-top: #1a5cc8 1px dashed }
h1 { color: #1A5CC8; text-align: center }

.text40{ width: 54px; height:22px }
.text60{ width: 80px; height:22px }
.text90{ width: 90px; height:22px }
.button40{ width: 54px; height:24px; background-color:F4FBFF; font-family:Tahoma; font-size:12px }
.footer_link{ font-family: Arial; font-size:12px; font-weight:bold; color:#1a5cc8 }
.banner{ font-family: Arial; font-weight: bold; font-size: 18px; color: #FFFFFF }
.hot {color:red }
.pagerunstatus { font-family:Arial;font-size:11px;color:green}
.table_header { font-family: Arial; font-weight: bold; font-size:12px; color: #ffffff; background-color:#1a5cc8; text-align:center }
.table_text { font-family: Tahoma; font-size:12px}
.code {word-wrap: break-word; word-break:break-all; background-color:#f4fbff; border:#b7cbff 1px dashed; font-size:12px; font-family: Courier New, Courier; text-align:left; padding:10px}
.fixedsize { word-wrap:break-word; word-break:break-all }

#contest_nav { word-wrap:break-word; width:980px; border:1px solid #1a5cc8; background-color:#1a5cc8; line-height:32px}
#contest_nav a { font-family: Arial; font-weight: bold; font-size: 18px; color: #FFFFFF; margin: 15px }
#contest_nav a:hover { font-family: Arial; font-weight: bold; font-size: 18px; color:orange; margin: 15px }
#contest_footer { width:980px; height:70px; border:1px solid #1a5cc8; text-align:center; padding: 5px 0}
#contest_footer div{ word-wrap:break-word }
#rollword { word-wrap:break-word; width:980px; margin-top:10px}

/* Panel对象的css */
div.panel_content {
	height: auto;
	background: url(panel-content.png) repeat-y;
	margin: 0;
	padding: 0 20px;
	font-size: 14px;
	font-family: Times New Roman;
	text-align: left
}
div.panel_title {
	height: 38px;
	background: transparent url(panel-title.png) left bottom no-repeat;
	padding: 0 14px;
	color: #7CA9ED;
	font-size: 18px;
	font-family: Arial;
	font-weight: bold
}
div.panel_bottom {
	height: auto;
	margin: 0;
	background: url(panel-bottom.png) left top no-repeat
}
div.panel_content pre {
	margin: 0;
	font-size: 14px
}
/* 高亮显示的项 */
#highlight_item{
	light:expression(onmouseover=function(){this.style.backgroundColor="#D7EBFF"},onmouseout=function(){this.style.backgroundColor="transparent"}) 
}

</style><style type="text/css">
#content{
	height:auto!important;
	height:120px;
	min-height:120px; 
	font-size:16px;
	margin:0 auto 20px auto;
	width:100%;
	
}
#maintable{
	text-align:center;
	font-size:14px;
	width:100%;
	margin:10px auto;
	
}
#maintable tr{
	height:19px;
}
.tbheader{
	font-family:Arial, Helvetica, sans-serif;
	font-size:12px;
	height:16px;
	background-color:#1a5cc8;
	color:white;
}
.tbheader a{
	color:white;
}
 .contype{
	font-size:14px;
	margin:10px auto;
	text-align:center;
}
.ctpublic{
	color:red;
}
.ctprivate{
	color:green;
}
.cspend{
	color:green;
}
.csend{
	color:gray;
}
.csrun{
	color:red;
}
#content h4{
	font-weight:normal;
	margin:3px auto 0;
	text-align:center;
	color:#1a5cc8;
	font-size:14px;
}
#content h2{
	margin:5px auto;
	text-align:center;
	font-size:18px;
}
#content #errormsg{
	font-family:Arial, Helvetica, sans-serif;
	font-size:13px;
	font-weight:bold;
	width:100%;
	color:red;
	text-align:center;
	margin:5px auto;
	padding:0;
}

/*DIY Contest 的相关表单*/
#content #mkcon{
	width:68%;
	margin:20px auto 0 200px;

}
#content #mkcon p{
	margin:10px auto;
}
#content #mkcon .timeinfo input{
	width:40px;
}
#content #mkcon .timeinfo span{
	border:#b7cbff 1px dashed;
}
#content #mkcon #diyconname{
	width:414px;
	margin-left:11px;
}
#content #mkcon #diyyear{
	margin-left:36px;
}
#content #mkcon #diylday{
	margin-left:21px;
}
#content #contesttype{
	margin-left:16px;
	border:none;
}
#content #contesttype2{
	margin-left:16px;
	border:none;
}

#content #mkcon #password{
	margin-left:33px;
	width:152px;
}
#content #mkpro{
	width:50%;
	margin:20px auto 20px 310px;
}
#content #mkpro h1{
	font-size:16px;
}
#content #mkpro p{
	text-align:center;
}
#content #mkpro #diyspid{
	margin-left:40px;
	width:40px;
}
#content #mkpro #diytpid{
	margin-left:85px;
	width:40px;
}
#content #mknotice{
	margin:auto;
	width:100%;
	height:100px;
}</style><style type="text/css">
#content{
	height:auto!important;
	height:120px;
	min-height:120px; 
	font-size:16px;
	margin:0 auto 20px auto;
	width:100%;
	
}
#maintable{
	text-align:center;
	font-size:14px;
	width:100%;
	margin:10px auto;
	
}
#maintable tr{
	height:19px;
}
.tbheader{
	font-family:Arial, Helvetica, sans-serif;
	font-size:12px;
	height:16px;
	background-color:#1a5cc8;
	color:white;
}
.tbheader a{
	color:white;
}
 .contype{
	font-size:14px;
	margin:10px auto;
	text-align:center;
}
.ctpublic{
	color:red;
}
.ctprivate{
	color:green;
}
.cspend{
	color:green;
}
.csend{
	color:gray;
}
.csrun{
	color:red;
}
#content h4{
	font-weight:normal;
	margin:3px auto 0;
	text-align:center;
	color:#1a5cc8;
	font-size:14px;
}
#content h2{
	margin:5px auto;
	text-align:center;
	font-size:18px;
}
#content #errormsg{
	font-family:Arial, Helvetica, sans-serif;
	font-size:13px;
	font-weight:bold;
	width:100%;
	color:red;
	text-align:center;
	margin:5px auto;
	padding:0;
}

/*WEB Contest 的相关表单*/
#content #mkcon{
	width:68%;
	margin:20px auto 0 200px;

}
#content #mkcon p{
	margin:10px auto;
}
#content #mkcon .timeinfo input{
	width:40px;
}
#content #mkcon .timeinfo span{
	border:#b7cbff 1px dashed;
}
#content #mkcon #webconname{
	width:414px;
	margin-left:11px;
}
#content #mkcon #webyear{
	margin-left:36px;
}
#content #mkcon #weblday{
	margin-left:21px;
}
#content #contesttype{
	margin-left:16px;
	border:none;
}
#content #contesttype2{
	margin-left:16px;
	border:none;
}

#content #mkcon #password{
	margin-left:33px;
	width:152px;
}
#content #mkpro{
	width:50%;
	margin:20px auto 20px 310px;
}
#content #mkpro h1{
	font-size:16px;
}
#content #mkpro p{
	text-align:center;
}
#content #mkpro #webspid{
	margin-left:0px;
	width:80px;
}

#content #mknotice{
	margin:auto;
	width:100%;
	height:100px;
}
</style><style type="text/css"></style></head><body>
<a name="top"></a>
<table align="center" border="0" cellpadding="0" cellspacing="0" style="word-wrap:break-word">



<tbody><tr><td align="center"><h1 style="color:#1A5CC8">ZCC loves Army</h1><font><b><span style="font-family:Arial;font-size:12px;font-weight:bold;color:green">Time Limit: 2500/1200 MS (Java/Others), Memory Limit: 65536/65536 K (Java/Others)</span></b></font><br><br><div align="left" class="panel_title">Problem Description</div> <div class="panel_content">   ZCC owns an army with n soldiers. Soldiers are numbered from 1 to n. Soldier 1 is the commander in chief. Each soldier has a <b>direct superior (which is called father in ACM)</b> except soldier 1. x is a <b>direct inferior (which is called son in ACM)</b> of y if and only if y is the direct superior of x. Soldier use an ordered list called <b>direct inferiors list</b> to manage his direct inferiors (The indexes begin with 1). If soldier A and soldier B are in the same direct inferiors list, and A is in front of B, then we say A’s level is higher than B. We assume that soldier 1 belongs to a direct inferior list that only contains soldier 1 for convenience.<br> <b>Messages</b> can be transmitted among the soldiers. A soldier can directly send messages to his direct superior, his direct inferior, and those who are in the same direct inferior list with him. Messages can also be sent indirectly. That means if x wants to send a message to y, he first send it directly to a third soldier z, then z send this message directly to y. In this case, we say z is involved in this transmission as a middleman. Message transmission that involves more than one middleman is also allowed.<br> <b>Orders</b> can be transmitted among the soldiers too. A soldier can directly give orders to his direct inferior and those who are in the same direct inferior list with him but have lower level. Orders can also be given indirectly. That means if x wants to give an order to y, he first give it to a third soldier z, then z give this order to y. In this case, we say z is involved in this transmission as a middleman. Order transmission that involves more than one middleman is also allowed.<br>   Unfortunately, sometimes some soldiers will change their direct superior. More specifically, event like “the p-th soldier to (p+c-1)-th soldier in soldier x’s direct inferior list change their direct superior to y and be inserted after the q-th soldier in y’s direct inferior list (if q=0, that means these soldiers are inserted in front of the first soldier in y’s direct inferior list)” will sometimes happen.<br>   To examine the efficiency of the transmission of the messages and orders, ZCC will ask two types of question: <br>   1) If soldier x want to send messages to soldier y, at least how many soldiers will be involved in this transmission as a middleman.<br>   2) How many soldiers can give orders to soldier x.<br>   Now, m events, including direct superior change events and ZCC’s questions, happen one by one. Can you answer all ZCC’s questions?</div><div class="panel_bottom">&nbsp;</div><br><div align="left" class="panel_title">Input</div> <div class="panel_content">   The first line contains two integers n and m, indicating the number of soldiers and the number of events.<br>   Then n lines follow, describing the initial direct inferior list of each soldier. The i-th line contains several integers. The first integer is k, indicating the number of soldier i’s direct inferior. Then k integers follow, indicating the direct inferior list of soldier i.<br>   After that m lines follow, describing the m events. Each line begins with an integer t, indicating the type of this event.<br>   If t = 1, then 5 integers x, p, c, y and q follow, indicating a direct superior change event;<br>   If t = 2, then 2 integers x and y follow, indicating ZCC’s question 1;<br>   If t = 3, then an integer x follows, indicating ZCC’s question 2.</div><div class="panel_bottom">&nbsp;</div><br><div align="left" class="panel_title">Output</div> <div class="panel_content">   For each question, output one line with one integer indicating your answer.</div><div class="panel_bottom">&nbsp;</div><br><div align="left" class="panel_title">Sample Input</div><div class="panel_content"><pre><div style="font-family:Courier New,Courier,monospace;">9 7
2 2 3
3 4 5 6
3 7 8 9
0
0
0
0
0
0
3 1
3 9
1 2 2 2 3 2
3 9
2 5 9
2 4 8
3 3</div></pre></div><div class="panel_bottom">&nbsp;</div><br><div align="left" class="panel_title">Sample Output</div><div class="panel_content"><pre><div style="font-family:Courier New,Courier,monospace;">0
5
7
0
2
2

<div style="font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px"><div style="font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed"><i>Hint</i></div>   n&lt;=100000, m&lt;=100000
   You can assume that the events are all legal, and the relationship among the soldiers forms a tree all the time.
</div><i style="font-size:1px"> </i></div></pre></div><div class="panel_bottom">&nbsp;</div><br><div align="left" class="panel_title">Author</div> <div class="panel_content">镇海中学</div><div class="panel_bottom">&nbsp;</div><br>  <br> <br></td></tr>
</tbody></table>

</body></html>