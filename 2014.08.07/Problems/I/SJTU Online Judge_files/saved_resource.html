<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- saved from url=(0038)http://172.16.45.6/problems/8306/html/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style>   body { font-family: 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif; }</style><meta content="width=768" name="viewport"><meta content="IE=edge" http-equiv="X-UA-Compatible"><title>1771. A Deputy's Morning @ Timus Online Judge</title><style type="text/css"></style></head><body alink="#1A5CC8" link="#1A5CC8" vlink="#1A5CC8"><div class="prnver"><h2 class="problem_title">1771. A Deputy's Morning</h2><div class="problem_limits">Time limit: 1.0 second<br>Memory limit: 64 MB<br><br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">There are exactly <i>n</i> bus stops and <i>m</i> bus routes in Yekaterinburg. The
traffic system is designed so that the distance between two adjacent stops is
covered by any bus in exactly one minute. Each bus starts its journey no
earlier than 7 am at an integer number of minutes and lets the passengers in at
the first stop of its route. No two buses can go on the same route
simultaneously. When a bus reaches the last stop of its route, it does not turn
round and go back. There is no bus schedule in Yekaterinburg, and buses can go
arbitrarily allowing for the above constraints.</div></div><div class="problem_par"><div class="problem_par_normal">Deputy of the City Duma Leonid decided to set up a social control of the public
transportation system. At 06:50 he came out to the bus stop nearest to his home
with a notebook. He spoke to the people who were waiting there and they
explained him the way they usually used buses. Everybody who wants to get into
a bus comes to a bus stop in advance, no later than at 06:59. Boarding and
debussing take no time at all because people are in a hurry. Each passenger
chooses a bus by the following algorithm.

<ul>
<li> If a bus that will take the passenger to the required bus stop arrives to
the stop, the passenger takes this bus.</li>
<li> If several suitable buses come to the bus stop simultaneously, then the
passenger takes the bus that will take them to the required stop earlier.</li>
<li> If there are several such buses, then the passenger takes the bus with
the minimal route number.</li>
</ul></div></div><div class="problem_par"><div class="problem_par_normal">At exactly 7 am Leonid started writing the route numbers of the passing buses
and the times at which they arrived to the stop. The crowd at the stop was
gradually diminishing. Leonid was starting to enjoy the process when he
suddenly remembered that he had to attend a session of the Collegiate
Programming Committee. Then he got into the bus that came to the bus stop.
There were 42 people in the bus and 13 people entered the bus in addition to
Leonid. Help him determine the minimum and maximum number of those people that
would be in the bus when it arrived to the stop where Leonid had to get off.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains the integers <i>n</i> and <i>m</i> separated with a space (3 ≤ <i>n</i>, <i>m</i> ≤ 100). The <i>i</i>-th of the following <i>m</i> lines describes the route with number <i>i</i>. The description is a sequence of pairwise distinct numbers from 1 to <i>n</i>, which are the numbers of stops on the route. Each route contains at least two stops. The list ends with the number −1. The numbers in the list are separated with a space. Leonid lives near the stop with number 1 and plans
to get off at the stop with number 2.
</div></div><div class="problem_par"><div class="problem_par_normal">The next line contains the number of buses <i>k</i> that Leonid recorded in
his notebook (1 ≤ <i>k</i> ≤ 100). Each of the following <i>k</i> lines contains the time when the bus arrived to the stop in the format <i>hh</i>:<i>mm</i>
(07 ≤ <i>hh</i> ≤ 23; 00 ≤ <i>mm</i> ≤ 59) and, after a space, the route number of this bus. The records in the notebook are time-ordered. The last in the list is the bus that Leonid took. It is known that the notebook also contains information on
all the buses that arrived to the stop simultaneously with the last bus. It is
guaranteed that the bus Leonid took has stop 2 in its route and that stop 1 is
not the first stop of this route.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">Output two integers separated with a space. These should be the
minimum and maximum numbers of people going with Leonid the whole way from
stop 1 to stop 2.</div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre class="intable">4 3
1 4 -1
4 1 -1
3 1 4 2 -1
2
07:00 1
07:10 3
</pre></td><td><pre class="intable">13 55
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Alex Samsonov<br><b>Problem Source: </b>The 14th Urals Collegiate Programing Championship, April 10, 2010<br><br></div></div></div><script type="text/javascript" async="" src="watch.js"></script><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({id:20918869, webvisor:true, clickmap:true, trackLinks:true, accurateTrackBounce:true}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img alt="" src="http://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;"/&gt;&lt;/div&gt;</noscript><iframe name="RemoteIframe" allowtransparency="true" style="position: absolute; left: -999px; top: -999px; width: 1px; height: 1px;"></iframe></body></html>