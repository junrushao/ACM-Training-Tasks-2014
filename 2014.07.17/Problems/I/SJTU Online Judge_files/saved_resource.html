
<!-- saved from url=(0038)http://172.16.45.6/problems/3755/html/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style>   body { font-family: 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif; }</style><meta content="HDOJ ACM ICPC OJ C C++ Pascal Java" name="keywords"><style type="text/css">body
{
	font-size:14px;
	font-family:Times New Roman;
	background: url(background.jpg);
}

a{ color:#1a5cc8; text-decoration:none }
a:hover { color:orange; text-decoration:underline }
textarea { border:#879BFF 1px dashed; background-color: F4FBFF }
input { border:#879BFF 1px dashed; font-size:14px; background-color:transparent; vertical-align: middle }
select { margin: -2px; background-color:F4FBFF }
img { border: none}
hr { height: 1px; border: 0; border-top: #1a5cc8 1px dashed }
h1 { color: #1A5CC8; text-align: center }

.text40{ width: 54px; height:22px }
.text60{ width: 80px; height:22px }
.text90{ width: 90px; height:22px }
.button40{ width: 54px; height:24px; background-color:F4FBFF; font-family:Tahoma; font-size:12px }
.footer_link{ font-family: Arial; font-size:12px; font-weight:bold; color:#1a5cc8 }
.banner{ font-family: Arial; font-weight: bold; font-size: 18px; color: #FFFFFF }
.hot {color:red }
.pagerunstatus { font-family:Arial;font-size:11px;color:green}
.table_header { font-family: Arial; font-weight: bold; font-size:12px; color: #ffffff; background-color:#1a5cc8; text-align:center }
.table_text { font-family: Tahoma; font-size:12px}
.code {word-wrap: break-word; word-break:break-all; background-color:#f4fbff; border:#b7cbff 1px dashed; font-size:12px; font-family: Courier New, Courier; text-align:left; padding:10px}
.fixedsize { word-wrap:break-word; word-break:break-all }

#contest_nav { word-wrap:break-word; width:980px; border:1px solid #1a5cc8; background-color:#1a5cc8; line-height:32px}
#contest_nav a { font-family: Arial; font-weight: bold; font-size: 18px; color: #FFFFFF; margin: 15px }
#contest_nav a:hover { font-family: Arial; font-weight: bold; font-size: 18px; color:orange; margin: 15px }
#contest_footer { width:980px; height:70px; border:1px solid #1a5cc8; text-align:center; padding: 5px 0}
#contest_footer div{ word-wrap:break-word }
#rollword { word-wrap:break-word; width:980px; margin-top:10px}

/* Panel对象的css */
div.panel_content {
	height: auto;
	background: url(panel-content.png) repeat-y;
	margin: 0;
	padding: 0 20px;
	font-size: 14px;
	font-family: Times New Roman;
	text-align: left
}
div.panel_title {
	height: 38px;
	background: transparent url(panel-title.png) left bottom no-repeat;
	padding: 0 14px;
	color: #7CA9ED;
	font-size: 18px;
	font-family: Arial;
	font-weight: bold
}
div.panel_bottom {
	height: auto;
	margin: 0;
	background: url(panel-bottom.png) left top no-repeat
}
div.panel_content pre {
	margin: 0;
	font-size: 14px
}
/* 高亮显示的项 */
#highlight_item{
	light:expression(onmouseover=function(){this.style.backgroundColor="#D7EBFF"},onmouseout=function(){this.style.backgroundColor="transparent"}) 
}

</style><style type="text/css">
#content{
	height:auto!important;
	height:120px;
	min-height:120px; 
	font-size:16px;
	margin:0 auto 20px auto;
	width:100%;
	
}
#maintable{
	text-align:center;
	font-size:14px;
	width:100%;
	margin:10px auto;
	
}
#maintable tr{
	height:19px;
}
.tbheader{
	font-family:Arial, Helvetica, sans-serif;
	font-size:12px;
	height:16px;
	background-color:#1a5cc8;
	color:white;
}
.tbheader a{
	color:white;
}
 .contype{
	font-size:14px;
	margin:10px auto;
	text-align:center;
}
.ctpublic{
	color:red;
}
.ctprivate{
	color:green;
}
.cspend{
	color:green;
}
.csend{
	color:gray;
}
.csrun{
	color:red;
}
#content h4{
	font-weight:normal;
	margin:3px auto 0;
	text-align:center;
	color:#1a5cc8;
	font-size:14px;
}
#content h2{
	margin:5px auto;
	text-align:center;
	font-size:18px;
}
#content #errormsg{
	font-family:Arial, Helvetica, sans-serif;
	font-size:13px;
	font-weight:bold;
	width:100%;
	color:red;
	text-align:center;
	margin:5px auto;
	padding:0;
}

/*DIY Contest 的相关表单*/
#content #mkcon{
	width:68%;
	margin:20px auto 0 200px;

}
#content #mkcon p{
	margin:10px auto;
}
#content #mkcon .timeinfo input{
	width:40px;
}
#content #mkcon .timeinfo span{
	border:#b7cbff 1px dashed;
}
#content #mkcon #diyconname{
	width:414px;
	margin-left:11px;
}
#content #mkcon #diyyear{
	margin-left:36px;
}
#content #mkcon #diylday{
	margin-left:21px;
}
#content #contesttype{
	margin-left:16px;
	border:none;
}
#content #contesttype2{
	margin-left:16px;
	border:none;
}

#content #mkcon #password{
	margin-left:33px;
	width:152px;
}
#content #mkpro{
	width:50%;
	margin:20px auto 20px 310px;
}
#content #mkpro h1{
	font-size:16px;
}
#content #mkpro p{
	text-align:center;
}
#content #mkpro #diyspid{
	margin-left:40px;
	width:40px;
}
#content #mkpro #diytpid{
	margin-left:85px;
	width:40px;
}
#content #mknotice{
	margin:auto;
	width:100%;
	height:100px;
}</style><style type="text/css">
#content{
	height:auto!important;
	height:120px;
	min-height:120px; 
	font-size:16px;
	margin:0 auto 20px auto;
	width:100%;
	
}
#maintable{
	text-align:center;
	font-size:14px;
	width:100%;
	margin:10px auto;
	
}
#maintable tr{
	height:19px;
}
.tbheader{
	font-family:Arial, Helvetica, sans-serif;
	font-size:12px;
	height:16px;
	background-color:#1a5cc8;
	color:white;
}
.tbheader a{
	color:white;
}
 .contype{
	font-size:14px;
	margin:10px auto;
	text-align:center;
}
.ctpublic{
	color:red;
}
.ctprivate{
	color:green;
}
.cspend{
	color:green;
}
.csend{
	color:gray;
}
.csrun{
	color:red;
}
#content h4{
	font-weight:normal;
	margin:3px auto 0;
	text-align:center;
	color:#1a5cc8;
	font-size:14px;
}
#content h2{
	margin:5px auto;
	text-align:center;
	font-size:18px;
}
#content #errormsg{
	font-family:Arial, Helvetica, sans-serif;
	font-size:13px;
	font-weight:bold;
	width:100%;
	color:red;
	text-align:center;
	margin:5px auto;
	padding:0;
}

/*WEB Contest 的相关表单*/
#content #mkcon{
	width:68%;
	margin:20px auto 0 200px;

}
#content #mkcon p{
	margin:10px auto;
}
#content #mkcon .timeinfo input{
	width:40px;
}
#content #mkcon .timeinfo span{
	border:#b7cbff 1px dashed;
}
#content #mkcon #webconname{
	width:414px;
	margin-left:11px;
}
#content #mkcon #webyear{
	margin-left:36px;
}
#content #mkcon #weblday{
	margin-left:21px;
}
#content #contesttype{
	margin-left:16px;
	border:none;
}
#content #contesttype2{
	margin-left:16px;
	border:none;
}

#content #mkcon #password{
	margin-left:33px;
	width:152px;
}
#content #mkpro{
	width:50%;
	margin:20px auto 20px 310px;
}
#content #mkpro h1{
	font-size:16px;
}
#content #mkpro p{
	text-align:center;
}
#content #mkpro #webspid{
	margin-left:0px;
	width:80px;
}

#content #mknotice{
	margin:auto;
	width:100%;
	height:100px;
}
</style><style type="text/css"></style></head><body>
<a name="top"></a>
<table align="center" border="0" cellpadding="0" cellspacing="0" style="word-wrap:break-word">



<tbody><tr><td align="center"><h1 style="color:#1A5CC8">In A Crazy City</h1><font><b><span style="font-family:Arial;font-size:12px;font-weight:bold;color:green">Time Limit: 10000/5000 MS (Java/Others), Memory Limit: 32768/32768 K (Java/Others)</span></b></font><br><br><div align="left" class="panel_title">Problem Description</div> <div class="panel_content">I live in a crazy city full of crossings and bidirectional roads connecting them. On most of the days, there will be a celebration in one of the crossings, that’s why I call this city crazy.<br><br>Everyday, I walk from my home (at crossing <i>s</i>) to my office (at crossing <i>t</i>). I don't like crowds, but I don't want to waste time either, so I always choose a shortest path among all possible paths that does not visit the crossing of the celebration. If no such path exists, I don’t go to work (it’s a good excuse, isn’t it)!<br><br>In order to analyze this “celebration effect” in detail, I need <i>n</i> pairs of values (<i>l<sub>i</sub></i>, <i>c<sub>i</sub></i>), where <i>l<sub>i</sub></i> is the length of the shortest path from crossing <i>s</i> to crossing <i>t</i>, not visiting crossing <i>i</i>, <i>c<sub>i</sub></i> is the number of such shortest paths (not visiting crossing <i>i</i>). Could you help me? Note that if I can’t go to work when celebration is held at crossing <i>i</i>, define <i>l<sub>i</sub></i> = <i>c<sub>i</sub></i> = 0. This includes the case when there is no path between <i>s</i> and <i>t</i> even if there’s no celebration at all.<br><br>Ah, wait a moment. Please don’t directly give me the values - that’ll drive me crazy (too many numbers!). All I need is finding some interesting conclusions behind the values, but currently I’ve no idea what exactly I want.<br><br>Before I know what you should calculate, please <b>prove</b> that you can indeed find all the pairs (<i>l<sub>i</sub></i>, <i>c<sub>i</sub></i>) by telling me the value of <i>f(x) = (l<sub>1</sub>+c<sub>1</sub>x+l<sub>2</sub>x<sup>2</sup>+c<sub>2</sub>x<sup>3</sup>+l<sub>3</sub>x<sup>4</sup>+c<sub>3</sub>x<sup>5</sup>+…+l<sub>n</sub>x<sup>2n-2</sup>+c<sub>n</sub>x<sup>2n-1</sup>)</i> mod 19880830, for some given <i>x</i>.</div><div class="panel_bottom">&nbsp;</div><br><div align="left" class="panel_title">Input</div> <div class="panel_content">There will be at most 20 test cases. Each case begins with 5 integers <i>n, m, s, t, q</i> (1 &lt;= <i>s,t</i> &lt;= <i>n</i> &lt;= 100,000, 0 &lt;= <i>m</i> &lt;= 500,000, 1 &lt;= <i>q</i> &lt;= 5). <i>n</i> is the number of crossings, <i>m</i> is the number of roads and <i>q</i> is the number of queries. <i>s</i> and <i>t</i> are different integers that represent my home and office, respectively. Each of the following <i>m</i> lines describes a road with three integers: <i>u, v, w</i> (1 &lt;= <i>u,v</i> &lt;= <i>n</i>, 1 &lt;= <i>w</i> &lt;= 10,000), indicating a bidirectional road connecting crossing <i>u</i> and crossing <i>v</i>, with length <i>w</i>. There may be multiple roads connecting the same pair of crossings, but a road cannot be connecting a crossing and itself. The next line contains <i>q</i> integers <i>x<sub>i</sub></i> (1 &lt;= <i>x<sub>i</sub></i> &lt;= 10<sup>9</sup>). The last test case is following by five zeros, which should not be processed.<br></div><div class="panel_bottom">&nbsp;</div><br><div align="left" class="panel_title">Output</div> <div class="panel_content">For each test case, print the case number and <i>q</i> integers <i>f(x<sub>1</sub>), f(x<sub>2</sub>), …, f(x<sub>q</sub>)</i> separated by a single space between consecutive items, on one line. Print a blank line after the output of each test case.<br></div><div class="panel_bottom">&nbsp;</div><br><div align="left" class="panel_title">Sample Input</div><div class="panel_content"><pre><div style="font-family:Courier New,Courier,monospace;">4 5 1 4 2
1 2 1
1 3 1
2 4 2
3 4 3
1 4 4
1 10
3 2 1 3 1
1 2 12
2 3 2
1
0 0 0 0 0</div></pre></div><div class="panel_bottom">&nbsp;</div><br><div align="left" class="panel_title">Sample Output</div><div class="panel_content"><pre><div style="font-family:Courier New,Courier,monospace;">Case 1: 10 132400

Case 2: 0

<div style="font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px"><div style="font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed"><i>Hint</i></div><b>Explanation</b>

In the first sample, <i>l1</i> = <i>c1</i> = 0, <i>l2</i> = 4, <i>c2</i> = 2, <i>l3</i> = 3, <i>c3</i> = 1, <i>l4</i> = <i>c4</i> = 0. In the second sample, everything is zero.</div><i style="font-size:1px"> </i></div></pre></div><div class="panel_bottom">&nbsp;</div><br>  <br> <br></td></tr>
</tbody></table>

</body></html>