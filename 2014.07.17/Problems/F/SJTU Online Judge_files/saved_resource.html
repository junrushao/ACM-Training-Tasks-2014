
<!-- saved from url=(0038)http://172.16.45.6/problems/3752/html/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style>   body { font-family: 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif; }</style><meta content="HDOJ ACM ICPC OJ C C++ Pascal Java" name="keywords"><style type="text/css">body
{
	font-size:14px;
	font-family:Times New Roman;
	background: url(background.jpg);
}

a{ color:#1a5cc8; text-decoration:none }
a:hover { color:orange; text-decoration:underline }
textarea { border:#879BFF 1px dashed; background-color: F4FBFF }
input { border:#879BFF 1px dashed; font-size:14px; background-color:transparent; vertical-align: middle }
select { margin: -2px; background-color:F4FBFF }
img { border: none}
hr { height: 1px; border: 0; border-top: #1a5cc8 1px dashed }
h1 { color: #1A5CC8; text-align: center }

.text40{ width: 54px; height:22px }
.text60{ width: 80px; height:22px }
.text90{ width: 90px; height:22px }
.button40{ width: 54px; height:24px; background-color:F4FBFF; font-family:Tahoma; font-size:12px }
.footer_link{ font-family: Arial; font-size:12px; font-weight:bold; color:#1a5cc8 }
.banner{ font-family: Arial; font-weight: bold; font-size: 18px; color: #FFFFFF }
.hot {color:red }
.pagerunstatus { font-family:Arial;font-size:11px;color:green}
.table_header { font-family: Arial; font-weight: bold; font-size:12px; color: #ffffff; background-color:#1a5cc8; text-align:center }
.table_text { font-family: Tahoma; font-size:12px}
.code {word-wrap: break-word; word-break:break-all; background-color:#f4fbff; border:#b7cbff 1px dashed; font-size:12px; font-family: Courier New, Courier; text-align:left; padding:10px}
.fixedsize { word-wrap:break-word; word-break:break-all }

#contest_nav { word-wrap:break-word; width:980px; border:1px solid #1a5cc8; background-color:#1a5cc8; line-height:32px}
#contest_nav a { font-family: Arial; font-weight: bold; font-size: 18px; color: #FFFFFF; margin: 15px }
#contest_nav a:hover { font-family: Arial; font-weight: bold; font-size: 18px; color:orange; margin: 15px }
#contest_footer { width:980px; height:70px; border:1px solid #1a5cc8; text-align:center; padding: 5px 0}
#contest_footer div{ word-wrap:break-word }
#rollword { word-wrap:break-word; width:980px; margin-top:10px}

/* Panel对象的css */
div.panel_content {
	height: auto;
	background: url(panel-content.png) repeat-y;
	margin: 0;
	padding: 0 20px;
	font-size: 14px;
	font-family: Times New Roman;
	text-align: left
}
div.panel_title {
	height: 38px;
	background: transparent url(panel-title.png) left bottom no-repeat;
	padding: 0 14px;
	color: #7CA9ED;
	font-size: 18px;
	font-family: Arial;
	font-weight: bold
}
div.panel_bottom {
	height: auto;
	margin: 0;
	background: url(panel-bottom.png) left top no-repeat
}
div.panel_content pre {
	margin: 0;
	font-size: 14px
}
/* 高亮显示的项 */
#highlight_item{
	light:expression(onmouseover=function(){this.style.backgroundColor="#D7EBFF"},onmouseout=function(){this.style.backgroundColor="transparent"}) 
}

</style><style type="text/css">
#content{
	height:auto!important;
	height:120px;
	min-height:120px; 
	font-size:16px;
	margin:0 auto 20px auto;
	width:100%;
	
}
#maintable{
	text-align:center;
	font-size:14px;
	width:100%;
	margin:10px auto;
	
}
#maintable tr{
	height:19px;
}
.tbheader{
	font-family:Arial, Helvetica, sans-serif;
	font-size:12px;
	height:16px;
	background-color:#1a5cc8;
	color:white;
}
.tbheader a{
	color:white;
}
 .contype{
	font-size:14px;
	margin:10px auto;
	text-align:center;
}
.ctpublic{
	color:red;
}
.ctprivate{
	color:green;
}
.cspend{
	color:green;
}
.csend{
	color:gray;
}
.csrun{
	color:red;
}
#content h4{
	font-weight:normal;
	margin:3px auto 0;
	text-align:center;
	color:#1a5cc8;
	font-size:14px;
}
#content h2{
	margin:5px auto;
	text-align:center;
	font-size:18px;
}
#content #errormsg{
	font-family:Arial, Helvetica, sans-serif;
	font-size:13px;
	font-weight:bold;
	width:100%;
	color:red;
	text-align:center;
	margin:5px auto;
	padding:0;
}

/*DIY Contest 的相关表单*/
#content #mkcon{
	width:68%;
	margin:20px auto 0 200px;

}
#content #mkcon p{
	margin:10px auto;
}
#content #mkcon .timeinfo input{
	width:40px;
}
#content #mkcon .timeinfo span{
	border:#b7cbff 1px dashed;
}
#content #mkcon #diyconname{
	width:414px;
	margin-left:11px;
}
#content #mkcon #diyyear{
	margin-left:36px;
}
#content #mkcon #diylday{
	margin-left:21px;
}
#content #contesttype{
	margin-left:16px;
	border:none;
}
#content #contesttype2{
	margin-left:16px;
	border:none;
}

#content #mkcon #password{
	margin-left:33px;
	width:152px;
}
#content #mkpro{
	width:50%;
	margin:20px auto 20px 310px;
}
#content #mkpro h1{
	font-size:16px;
}
#content #mkpro p{
	text-align:center;
}
#content #mkpro #diyspid{
	margin-left:40px;
	width:40px;
}
#content #mkpro #diytpid{
	margin-left:85px;
	width:40px;
}
#content #mknotice{
	margin:auto;
	width:100%;
	height:100px;
}</style><style type="text/css">
#content{
	height:auto!important;
	height:120px;
	min-height:120px; 
	font-size:16px;
	margin:0 auto 20px auto;
	width:100%;
	
}
#maintable{
	text-align:center;
	font-size:14px;
	width:100%;
	margin:10px auto;
	
}
#maintable tr{
	height:19px;
}
.tbheader{
	font-family:Arial, Helvetica, sans-serif;
	font-size:12px;
	height:16px;
	background-color:#1a5cc8;
	color:white;
}
.tbheader a{
	color:white;
}
 .contype{
	font-size:14px;
	margin:10px auto;
	text-align:center;
}
.ctpublic{
	color:red;
}
.ctprivate{
	color:green;
}
.cspend{
	color:green;
}
.csend{
	color:gray;
}
.csrun{
	color:red;
}
#content h4{
	font-weight:normal;
	margin:3px auto 0;
	text-align:center;
	color:#1a5cc8;
	font-size:14px;
}
#content h2{
	margin:5px auto;
	text-align:center;
	font-size:18px;
}
#content #errormsg{
	font-family:Arial, Helvetica, sans-serif;
	font-size:13px;
	font-weight:bold;
	width:100%;
	color:red;
	text-align:center;
	margin:5px auto;
	padding:0;
}

/*WEB Contest 的相关表单*/
#content #mkcon{
	width:68%;
	margin:20px auto 0 200px;

}
#content #mkcon p{
	margin:10px auto;
}
#content #mkcon .timeinfo input{
	width:40px;
}
#content #mkcon .timeinfo span{
	border:#b7cbff 1px dashed;
}
#content #mkcon #webconname{
	width:414px;
	margin-left:11px;
}
#content #mkcon #webyear{
	margin-left:36px;
}
#content #mkcon #weblday{
	margin-left:21px;
}
#content #contesttype{
	margin-left:16px;
	border:none;
}
#content #contesttype2{
	margin-left:16px;
	border:none;
}

#content #mkcon #password{
	margin-left:33px;
	width:152px;
}
#content #mkpro{
	width:50%;
	margin:20px auto 20px 310px;
}
#content #mkpro h1{
	font-size:16px;
}
#content #mkpro p{
	text-align:center;
}
#content #mkpro #webspid{
	margin-left:0px;
	width:80px;
}

#content #mknotice{
	margin:auto;
	width:100%;
	height:100px;
}
</style><style type="text/css"></style></head><body>
<a name="top"></a>
<table align="center" border="0" cellpadding="0" cellspacing="0" style="word-wrap:break-word">



<tbody><tr><td align="center"><h1 style="color:#1A5CC8">Final Combat</h1><font><b><span style="font-family:Arial;font-size:12px;font-weight:bold;color:green">Time Limit: 20000/20000 MS (Java/Others), Memory Limit: 32768/32768 K (Java/Others)</span></b></font><br><br><div align="left" class="panel_title">Problem Description</div> <div class="panel_content">You’re playing an RPG, which is arguably the best Chinese RPG in 2007. You got to the final combat. You want to win as soon as possible. Do you know what I am talking about?<br><br><b>For competitors who're not familiar with the game</b>: we're giving a brief introduction to the combat system and the characters involved in that last combat very soon.<br><br><b>For competitors who're too familiar with the game</b>: we're simplifying and/or changing the rules and facts for this problem. We apologize if you feel unhappy about that.<br><br><center><img src="3235-1.jpg"></center><br><center>Fig. The final combat</center><br>The screenshot above gives you some idea about the combat system and the characters, which can be summarized as follows:<br><br><li>You have 4 heroes: Yun Tianhe (YTH), Han Lingsha (HLS), Liu Mengli (LML) and Murong Ziying (MRZY). Before the combat begins, you need to choose <b>exactly</b> three heroes and rearrange them in some order. Let's call the 1st, 2nd and 3rd hero H1, H2 and H3, respectively. In this screenshot above, H1 is YTH, H2 is HLS and H3 is LML. (Sorry for the Ziying fans!)</li><br><li>There are two bosses: Xuan Xiao (XX) and Su Yao (SY), both in the back of the screenshot.</li><br><li>The goal of this combat is to defeat SY. In this problem, you can assume that XX is immortal, although it's possible to defeat him in the real game.</li><br>The key to this problem is to understand the "semi" round-based combat system. See the <b>"progress bar"</b> on the top of the screen? Each hero has a very small <b>progress ball</b> (in light-blue) on the bar, with an icon above the ball. Similarly, each boss also has a ball (in red), but the icon is below the ball. When the combat begins, all the progress balls start moving from the left corner of the bar. When a ball reaches the right corner, the corresponding character is able to act. If more than one character can act, they make actions one by one, according to this precedence order: YTH, HLS, LML, MRZY, XX, SY. When a character is acting, all progress balls stopped moving. After a character finished an action, his/her progress ball is reset to the left corner of the progress bar. When nobody is acting, all progress balls go right simultaneously (but possibly with different speeds, see below).<br><br>In this problem, each character has 4 main properties: Jing, Qi, Shen, Su.<br><br><li><b>Jing</b> means "health". When a character's Jing reaches zero or negative, he/she is defeated. A character's maximum Jing is denoted by parameter <i>maxjing</i>.</li><br><li><b>Qi</b> means "vitality". It is used by special-skill attacks. When Qi is not enough, certain special-skill attacks cannot be performed. A character's maximum Qi is always 100.</li><br><li><b>Shen</b> means "spirit". It is used by Xian Shu (something similar to, but more amazing than "magic"). When Shen is not enough, certain Xian Shu cannot be performed. A character's maximum Shen is denoted by parameter <i>maxshen</i>.</li><br><li><b>Su</b> means "speed". It affects how quick a character's progress ball moves. Su is always a positive integer <b>less</b> than 5. If a character's Su is <i>x</i>, it takes 5-<i>x</i> units time for his/her progress ball to move from left corner to the right corner of the progress bar. A character's Su (which is never changed during the combat) is denoted by parameter <i>su</i>.</li><br>For simplicity, you may assume that both XX and SY use the same strategy:<br><br><li>In his/her (4<i>n</i>+1)-th action (<i>n</i>=0,1,2,...), make a weapon attack upon H1.</li><br><li>In his/her (4<i>n</i>+2)-th action (<i>n</i>=0,1,2,...), make a weapon attack upon H2.</li><br><li>In his/her (4<i>n</i>+3)-th action (<i>n</i>=0,1,2,...), make a weapon attack upon H3.</li><br><li>In his/her (4<i>n</i>+4)-th action (<i>n</i>=0,1,2,...), make a special-skill attack upon all the heroes.</li><br>Now we introduce four more parameters for each hero. The first two, <i>d1x</i> and <i>d2x</i>, are the damages that the hero takes on XX's weapon attack and special-skill attack, respectively. For SY's attacks, we define <i>d1s</i> and <i>d2s</i> similarly.<br><br>You’re very tired, so you don't want to waste your time designing complex tactics. When a hero is about to act, you only consider the following actions:<br><br><li><b>Make a physical weapon attack</b> upon either XX or SY (cannot attack both). Be warned though, SY is surrounded by swords (see the screenshot), so making weapon attacks upon her would hurt the attacker himself/herself. The amount of "reflection damage" that the attacker takes is the same as the "physical damage" that SY takes. Attacking XX (yes, you <b>can</b> do that, if you like) does <b>not</b> suffer from physical reflection.</li><br><li><b>Use Xian Shu to recover Jing.</b> To make your brain easier, you decided <b>not</b> to recover other heroes' Jing. In this problem, the only Xian Shu that you can use is called "Yu Run", which recovers <i>yurun_jing</i> points of Jing (if the resulting Jing exceeds his/her maximum Jing, it is reduced to the maximum) and uses <i>yurun_shen</i> points of Shen.</li><br><li><b>Use items to recover Shen.</b> To make your brain easier, you decided <b>not</b> to recover other heroes' Shen. In this problem, the only item that you can use is called "Shu Er Guo", which recovers <i>shuerguo_shen</i> points of Shen (if the resulting Shen exceeds his/her maximum Shen, it is reduced to the maximum). You have an infinite number of Shu Er Guo.</li><br><li><b>Make a special-skill attack</b> if his/her Qi is enough. Each hero has exactly one special-skill attack, attacking both XX and SY. Note that some special-skill attacks are physical. Using a physical special-skill attack makes you take the same damage as SY, just like weapon attacks.</li><br>Now it's time to introduce four more parameters for each hero: <i>wad</i>, <i>ssd</i>, <i>ssq</i> and <i>ssp</i>. The number of Jing points that SY takes by the hero's weapon attacks and special-skill attacks are denoted by <i>wad</i> and <i>ssd</i>, respectively. The special-skill attack is physical if and only if <i>ssp</i>=1 (otherwise, <i>ssp</i>=0). It needs <i>ssq</i> points of Qi.<br><br>As you may have noticed, Qi cannot be recovered by Xian Shu or items. There are only two ways to increase Qi: make a weapon attack, or get hit by a weapon attack. Being hurt by physical reflection does <b>not</b> earn you extra Qi.<br><br>So here come the last two parameters for each hero: <i>q</i>1 and <i>q</i>2, that means making a weapon attack increases <i>q</i>1 points of Qi (whether or not you're reflected), while getting hit by a weapon attack increases <i>q</i>2 points of Qi. If the resulting Qi exceeds his/her maximum Qi (which is always 100), it is reduced to the maximum. Again, performing a special-skill attack never increases your Qi. Getting hurt by the bosses' special-skill attacks never increases your Qi, either.<br><br>As a perfectionist, you don't want any hero to be defeated even temporarily (in the real game you can rebirth a hero with certain Xian Shu or items) - for example, it's <b>not</b> allowed to make YTH and SY defeated at the same time (it can happen, for example, after YTH has performed a powerful physical special-skill attack).<br><br>Finally comes the question: what is the earliest time (we only care about ball-moving time, not including time needed to make attacks) that you can win the combat, if you play optimally? To play optimally, you need to choose between the options listed above, for each act. It's not as easy as it sounds. Be <b>careful</b>!</div><div class="panel_bottom">&nbsp;</div><br><div align="left" class="panel_title">Input</div> <div class="panel_content">There will be at most 100 test cases. Each case begins with 6 positive integers, <i>SY_jing</i> (SY's initial Jing), <i>XX_su</i> (XX's Su), <i>SY_su</i> (SY's Su), <i>yurun_jing</i>, <i>yurun_shen</i> and <i>shuerguo_shen</i>. The next four lines contain descriptions of YTH, HLS, LML and MRZY, in this order. Each line contains 16 non-negative integers: <i>maxjing, maxshen, su, d1x, d2x, d1s, d2s, wad, ssd, ssq, ssp, q1, q2, jing, qi, shen</i>. The last three parameters are the initial Jing, Qi and Shen values of this hero before the combat begins. The limits of most parameters are listed below:<br><br><center><img src="3235-2.JPG"></center><br>And finally, 1 &lt;= <i>jing</i> &lt;= <i>maxjing</i>, 0 &lt;= <i>qi</i> &lt;= 100, 0 &lt;= <i>shen</i> &lt;= <i>maxshen</i>. The last test case is followed by 6 zeros, which should not be processed.</div><div class="panel_bottom">&nbsp;</div><br><div align="left" class="panel_title">Output</div> <div class="panel_content">For each test case, print the earliest time that you can win, and all possible orderings to achieve this. Each ordering is expressed as the concatenation of the first letters of H1, H2 and H3's names. For example, if H1=HLS, H2=LML, H3=YTH, the ordering is expressed as HLY. The orderings should be sorted in increasing order lexicographically. If you can't win the combat within 12 units of ball-moving time, print -1. Print a blank line after the output of each test case.</div><div class="panel_bottom">&nbsp;</div><br><div align="left" class="panel_title">Sample Input</div><div class="panel_content"><pre><div style="font-family:Courier New,Courier,monospace;">1000 1 1 200 15 75
1000 100 1 2000 2000 2000 2000 300 800 20 0 5 5
900 10 100
1000 100 1 2000 2000 2000 2000 120 300 10 0 5 5
100 80 100
1000 100 1 2000 2000 2000 2000 100 400 30 1 5 5
450 40 100
1000 100 1 2000 2000 2000 2000 250 700 10 1 5 5
600 50 100
3000 4 1 800 15 75
2000 100 3 2 2 2 2 1 1 1 0 2 1 1000 100 100
2000 100 4 2 2 2 2 1 1000 25 0 2 1 1 1 100
2000 100 1 2 2 2 2 1 1000 1 1 1 1 300 100 0
2000 100 3 2 2 2 2 1 1000 30 0 5 1 1 6 100
26399 3 2 3182 543 800
4462 353 2 4300 4875 6856 5527 31497 5633 61 0 68
63 4355 0 351
5444 300 3 7682 1037 597 4214 6744 6861 68 0 65 12
2136 32 143
5875 705 2 2097 118 2366 978 14276 24850 48 0 55
70 3562 40 277
6413 33 1 6305 1898 340 5238 13989 25287 25 1 72
34 3176 4 30
0 0 0 0 0 0</div></pre></div><div class="panel_bottom">&nbsp;</div><br><div align="left" class="panel_title">Sample Output</div><div class="panel_content"><pre><div style="font-family:Courier New,Courier,monospace;">Case 1: 4 HLY HYL LHY LYH YHL YLH

Case 2: 12 HML

Case 3: -1

<div style="font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px"><div style="font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed"><i>Hint</i></div><b>Explanation</b>

In the first sample, you can win the combat just after one action for each hero (at time 4, since all the su values are 1), but you need to be careful.

YTH's special-skill attack is powerful (damage=900), but his Qi is not enough (10&lt;20). You can't use HLS's weapon attack, since she'll get defeated by physical
 reflection. LML's weapon attack is weak, but she can use her special-skill attack even though she'll get hurt by reflection (her special-skill attack is physical), 
since 400&lt;450. For MRZY, his special-skill is physical, and too powerful, so we can't use it, since 700&gt;600.

To summarize, we can use YTH's weapon attack (damage=300), HLS's special-skill attack (damage=300), LML's weapon attack (damage=100) and special-skill 
attack (damage=400), and MRZY's weapon attack (damage=250). It's not hard to see, the only possible combination that can finish the combat in the quickest 
way is YTH, HLS and LML (use special-skill attack), the ordering is arbitrary. Note that the combat ends immediately after SY is defeated, so don't worry about 
the terrible attacks of XX and SY.

In the second sample, YTH is too weak so we ignore him immediately. You can't avoid XX's first attack, which is able to defeat everyone except LML, so LML 
seems to be the only possible H1. However, HLS moves before XX, so she can also be H1 if she uses Yu Run in her first action. Unfortunately, MRZY can't be 
H1, since he's not quick enough to recover Jing before XX attacks.

All the weapon attacks are too weak, so the best strategy is to accumulate Qi first, then perform the powerful special-skill attacks when possible. LML's su is 
too low, but her Qi is enough at startup. All she needs to do is to recover Shen, then recover Jing, and then do the attack (Why so complex? because her 
powerful special-skill attack is physical…). Note that SY is only able to attack two heroes before the combat ends, so H3 has one fewer chance to increase Qi 
by reflection. Actually, it can be proven that neither HLS nor MRZY can be H3 - if so, they'll be unable to gain enough Qi for their special-skill attacks.

To summarize, HLS can be H1 or H2, LML can be all, while MRZY can only be H1. So the only possible ordering is H1=HLS, H2=MRZY, H3=LML.

In the third sample, it seems that you can defeat SY with HLS's special-skill attack (damage=6861) and LML's specialskill attack (damage=24850). However, LML 
needs to recover Jing to avoid being defeated, but her initial Shen is not enough If we changed her initial Shen to 543 (enough for Yu Run), the answer would 
become "6 LYH LYM".
</div><i style="font-size:1px"> </i></div></pre></div><div class="panel_bottom">&nbsp;</div><br>  <br> <br></td></tr>
</tbody></table>

</body></html>